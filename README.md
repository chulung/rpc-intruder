# RPC-intruder
RPC-intruder 是一个用于开发过程中的RPC辅助测试框架。

其目的是为了解决注册中心不可达，网络环境隔离等情况下，本地应用调试远程服务的问题，以加快开发效率。

严格来说，这么做是不符合安全标准的，但跟app的热修复补丁类似，这是一个为了提升开发效率的折中手段。
如果没有这个，现有的一些大型项目的调试时间会被拉长数倍。

**本框架不应该暴露到生成环境中。**

# 2.起步

# 3.技术细节

RPC-intruder本质上是一个RPC框架，基于传输协议为HTTP，序列化框架为Hessian。
但没有生产级服务化框架的注册，负载，服务治理等等功能，因此非常适合集成到开发环境中，便于快速测试。

## 传输协议-HTTP

对于多环境的分布式应用，注册中心是隔离的。用来发布rpc服务的端口不会对外开放，也无法直连。
而HTTP的80端口则是一个例外，因此直接使用HTTP，通过80端口执行远程调用是一个绕过防火墙的方法。

## 序列化-hessian

在RPC框架中，使用何种序列化框架有非常多的讨论，根据不同场景各有考量。
在开发此项目时测试过JDK、json、kryo、hessian等多个框架，但最终只有hessian经受了公司各种复杂的对象和接口的考验。

- JDK

JDK序列化除了本身笨重的的原因之外，最大的问题是对于继承关系的序列化。
如果父类没有实现序列化接口，子类实现了，父类的字段是不会被序列化的。
虽然按开发规范，所有Bean应该实现序列化接口，然而实际中接口提供方经常存在不按规范的场景，JDK序列化对此无力。

- json

尝试的另一个序列化机制是json，包括fastjson和jackson。
但json最大的问题是依赖特定结构，本身不包含类信息，遇到不规范类，多层嵌套，循环依赖，泛型等场景很难解析正确。

比如曾遇到过如下类定义，对boolean定义了两个getter，按照一般的编程规范是不对的，但接口方就是这么提供了。
由于jackson是通过反射getter获取字段值，这种场景根本无法区分调用哪个，直接抛异常。
    ...
    
    private boolean success;
    
    public boolean isSuccess(){
        return this.success;
    }
    
    public boolean getSuccess(){
        return this.success;
    }
    
    ...

- kryo

kyro这个框架也有一定的知名度，效率也不错。
但使用时需要注册类信息，对泛型处理也容易出错，实际使用起来不怎么顺手。

- hessian

最后还是使用了hessian，我所经历的几个自研的生产级RPC框架中，hessian也是主要的序列化框架。
不得不说大家都用的东西都是经过考验的。稳定性，兼容性目前使用来看是最好的。

虽然有个小坑就是包括4.07在内的多个版本由于缺失配置导致BigDecimal无法序列化。
本框架已经集成了修复补丁，即src/main/resources/META-INF/hessian下的两个描述文件。

# 4.LICENSE
[The MIT License](LICENSE)